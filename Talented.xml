<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/ ..\FrameXML\UI.xsd">

<Script file="Talented.lua" />

<Frame name="TalentedPopup" parent="UIParent" hidden="true">
    <!--UIPanelDialogTemplate!-->
    <!--GlowBoxTemplate!-->
    <!--BasicFrameTemplate!-->
    <!--HelpPlateBox!-->

    <Size x="250" y="300" />
    <Anchors>
        <Anchor point="CENTER" />
    </Anchors>

    <Layers>
        <Layer level="BACKGROUND">
            <Texture>
                <Color r="0" g="0" b="0" a="0.9" />
            </Texture>
        </Layer>
        <Layer level="BORDER"></Layer>
        <Layer level="OVERLAY">
            <FontString name="$parent_Title" parentKey="title" inherits="ChatFontNormal" text="Talented">
                <Anchors>
                    <Anchor point="TOP">
                        <Offset x="0" y="-18" />
                    </Anchor>
                </Anchors>
            </FontString>
        </Layer>
    </Layers>

    <Scripts>
        <Onload>
            self:SetPoint("CENTER","UIParent","TOP",0,-(GetScreenHeight()/3))
        </Onload>
        <OnShow>
        </OnShow>
    </Scripts>

    <Frames>

<!-- EDIT BOX !-->
        <EditBox name="$parentInput" letters="17" autoFocus="false">
            <Size x="225" y="20" />
            <Anchors>
                <Anchor point="TOP">
                    <Offset y="-45" />
                </Anchor>
            </Anchors>

            <Layers>
                <Layer level="BACKGROUND">
                    <Texture>
                        <Color r="0.1" g="0.1" b="0.1" a="1.0" />
                    </Texture>
                </Layer>
            </Layers>
            <FontString inherits="ChatFontNormal"/>

            <Scripts>
                <OnEscapePressed>
                    HideParentPanel(self)
                </OnEscapePressed>
                <OnEnterPressed>
                    self:ClearFocus()
                </OnEnterPressed>
                <OnShow>
                    self:SetText("New build name....")
                    self:HighlightText()
                    self:SetFocus()
                </OnShow>
                <OnHide>
                    self:SetText("")
                </OnHide>
            </Scripts>
        </EditBox>

<!-- Ignore Tiers Pane !-->

        <Frame name="TalentedTierAnchor">
            <Size x="1" y="1" />
            <Anchors>
                <Anchor point="TOP" relativePoint="TOP">
                    <Offset y="-90" />
                </Anchor>
            </Anchors>
        </Frame>




<!-- BUTTON !-->
        <Button name="$parentButton" text="Save Build">
            <!--UIPanelButtonTemplate !-->

            <Size x="225" y="21" />
            <ButtonText>
                <Anchors>
                    <Anchor point="CENTER" />
                </Anchors>
            </ButtonText>

            <NormalFont style="ChatFontNormal" />
            <NormalTexture name="$parentBG">
                <Color r="0.4" g="0.4" b="0.4" a="0.4" />
            </NormalTexture>

            <Layers>
                <Layer level="BACKGROUND">
                    <Texture>
                        <Color r="0.2" g="0.2" b="0.2" a="0.8" />
                    </Texture>
                </Layer>
            </Layers>
            <Anchors>
                <Anchor point="BOTTOM">
                    <Offset y="13" />
                </Anchor>
            </Anchors>
            <Scripts>
                <OnLoad>
                    self.mode_key = nil
                    self.build_code = nil
                    self.ignoreKeys = nil
                </OnLoad>
                <OnEnter>
                    self:GetNormalTexture():SetVertexColor(0,1,1)
                </OnEnter>
                <OnShow>
                    TalentedPrepKeys(self.ignoreKeys,self.mode_key)
                </OnShow>
                <OnLeave>
                    self:GetNormalTexture():SetVertexColor(1,1,1)
                </OnLeave>
                <OnClick>
                    local tierIgnoreCode = TalentedProcessIgnoreKeys(self.ignoreKeys)
                    self.build_code = TalentedIgnoreSmush(self.build_code,tierIgnoreCode)
                    TalentedSaveActiveBuild(self.build_code,self.mode_key,TalentedPopupInput:GetText())
                    HideParentPanel(self);
                </OnClick>
            </Scripts>
        </Button>
    </Frames>

</Frame>

<Button name = "TalentedIgnoreTierTemplate" hidden="true" virtual="true">
    <Size x="200" y="20" />
    <ButtonText>
        <Anchors>
            <Anchor point="CENTER" />
        </Anchors>
    </ButtonText>

    <NormalFont style="ChatFontNormal" />

    <NormalTexture>
        <Color r="0.4" g="0.4" b="0.4" a="0.4" />
    </NormalTexture>

    <Layers>
        <Layer level="BACKGROUND">
            <Texture>
                <Color r="0.2" g="0.2" b="0.2" a="1" />
            </Texture>
        </Layer>
    </Layers>

    <Anchors>
        <Anchor point="CENTER" relativeTo="TalentedTierAnchor" relativePoint="CENTER"/>
    </Anchors>

    <Scripts>
        <OnLoad>
            self.color = self:GetNormalTexture()
        </OnLoad>
        <OnShow>
            self.selected = true
            self:SetAlpha(1)
            self.color:SetVertexColor(0,1,0)
        </OnShow>
        <OnEnter>
            self.color:SetVertexColor(0,0,1)
        </OnEnter>
        <OnLeave>
            if self.selected then
                self:SetAlpha(1)
                self.color:SetVertexColor(0,1,0)
            else
                self:SetAlpha(0.2)
                self.color:SetVertexColor(1,0,0)
            end
        </OnLeave>
        <OnClick>
            self.selected = not self.selected

            if self.selected then
                self:SetAlpha(1)
                self.color:SetVertexColor(0,1,0)
            else
                self:SetAlpha(0.2)
                self.color:SetVertexColor(1,0,0)
            end
        </OnClick>
    </Scripts>
</Button>




    <!-- SAVED BUILDS DROPDOWN BOX !-->

<Button name="TalentedPvETemplate" inherits="UIDropDownMenuTemplate" parent="PlayerTalentFrameTalents" virtual="true" hidden="true">
    <!--Should inherit TalentedSavedBuildsDropdownTemplate but that functionality isn't well-understood enough yet!-->
    <Anchors>
        <Anchor point="BOTTOMRIGHT" relativePoint="TOPRIGHT">
            <Offset x="-110" y="0" />
        </Anchor>
    </Anchors>

    <Scripts>
        <OnLoad>
            UIDropDownMenu_Initialize(self,TalentedInitDropdownPvE);
            self.TimeSinceLastUpdate = 10; --Set it over threshold (0.3 at time of writing) o update on first viewing
        </OnLoad>
        <OnUpdate>
            TalentedUpdateButtonText_OnUpdate(self,elapsed,"PvE")
        </OnUpdate>
    </Scripts>
</Button>

<Button name="TalentedSavedBuildsDropdownPvP" inherits="UIDropDownMenuTemplate" parent="PlayerTalentFramePVPTalents" virtual="true">
    <Anchors>
        <Anchor point="BOTTOMRIGHT">
            <Offset x="-108" y="-29" />
        </Anchor>
    </Anchors>

    <Scripts>
        <OnLoad>
            UIDropDownMenu_Initialize(self,TalentedInitDropdownPvP)
            self.TimeSinceLastUpdate = 0;
        </OnLoad>
        <OnUpdate>
            TalentedUpdateButtonText_OnUpdate(self,elapsed,"PvP")
        </OnUpdate>

    </Scripts>
</Button>





    <!-- PlayerTalentFrameTalents !-->
    <!-- PlayerTalentFramePVPTalents!-->

</Ui>